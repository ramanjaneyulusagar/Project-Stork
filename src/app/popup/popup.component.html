<div class="popup" *ngIf="backend.openDialog">
  {{checkEdit()}}
  <div class="content">
    <div class="grid">
      <div class="left">
        <div class="center">
          <button
            [ngClass]="{ 'tab-btn': true, active: currentTab === 'functions' }"
            (click)="changeTab('functions')"
          >
            Functions
          </button>
          <button
            [ngClass]="{ 'tab-btn': true, active: currentTab === 'elements' }"
            (click)="changeTab('elements')"
          >
            Elements
          </button>
        </div>
        <br />
        <div *ngIf="currentTab == 'functions'" class="row inbox">
          <app-feature
            *ngFor="let func of backend.functions"
            [feature]="func"
            [canDisable]="false"
          ></app-feature>
        </div>
        <div *ngIf="currentTab == 'elements'" class="row inbox">
          <app-feature
            *ngFor="let col of backend.columns"
            [feature]="col"
            [canDisable]="false"
          ></app-feature>
        </div>
      </div>
      <div class="right">
        <div class="function-box">
          <div class="title">Function</div>
          <div class="body">
            <app-drop-target
              *ngIf="!function"
              (onDrop)="onFunctionDrop($event)"
            ></app-drop-target>
            <div *ngIf="function" #ref class="row">
              {{ function.name | functionname }}(<div class="row" *ngFor="let field of function.fields; let i = index"><div class="row" (drop)="onElementDrop($event)" (dragover)="dragover($event)" contenteditable="true">
                    {{ field.id }}
                  </div><span>{{ i < function.fields.length - 1 ? ", " : "" }}</span></div>)
            </div>
          </div>
          <div class="actions">
            <button (click)="onClose('cancel')">Cancel</button>
            <button (click)="clearFunction()">Clear</button>
            <button (click)="validate()">Validate</button>
            <button [disabled]="!validated" (click)="apply()">Apply</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
